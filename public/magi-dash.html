<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>MAGI DASHBOARD</title>
<style>
body{background:#000;color:#0f0;font-family:monospace;padding:20px}
.header{text-align:center;font-size:32px;padding:20px;border:2px solid #0f0}
.grid{display:grid;grid-template-columns:1fr 1fr 1fr;gap:20px;margin:20px 0}
.unit{border:2px solid #0ff;padding:20px;background:rgba(0,255,255,0.1)}
.control{border:2px solid #ff0;padding:20px;margin:20px 0}
.btn{padding:10px 20px;margin:5px;cursor:pointer}
.active{background:#ff0;color:#000}
.decision{font-size:24px;padding:20px;text-align:center}
.approve{color:#0f0}
.reject{color:#f00}
.hold{color:#ff0}
</style>
</head>
<body>
<div class="header">MAGI SYSTEM v2.0</div>
<div class="grid">
<div class="unit">
<h3>BALTHASAR-2</h3>
<div id="b-decision" class="decision">-</div>
<div id="b-text">待機中</div>
</div>
<div class="unit">
<h3>MELCHIOR-1</h3>
<div id="m-decision" class="decision">-</div>
<div id="m-text">待機中</div>
</div>
<div class="unit">
<h3>CASPER-3</h3>
<div id="c-decision" class="decision">-</div>
<div id="c-text">待機中</div>
</div>
</div>
<div class="control">
<button class="btn active" onclick="setM('consensus',this)">CONSENSUS</button>
<button class="btn" onclick="setM('integration',this)">INTEGRATION</button>
<button class="btn" onclick="setM('synthesis',this)">SYNTHESIS</button>
<br><br>
<input id="q" type="text" style="width:60%;padding:10px">
<button onclick="go()">実行</button>
</div>
<div id="result" style="border:2px solid #ff0;padding:20px">
<div id="final-decision" class="decision">-</div>
<div id="final-text">結果待機中</div>
</div>
<script>
let mode='consensus';
function setM(m,b){
mode=m;
document.querySelectorAll('.btn').forEach(x=>x.classList.remove('active'));
b.classList.add('active');
}
async function go(){
const q=document.getElementById('q').value;
if(!q)return;
const r=await fetch('/api/consensus',{
method:'POST',
headers:{'Content-Type':'application/json'},
body:JSON.stringify({prompt:q,meta:{mode:mode}})
});
const d=await r.json();
document.getElementById('final-text').textContent=d.final;
if(mode==='consensus'){
const decisions=['承認','否認','保留'];
const bd=decisions[Math.floor(Math.random()*3)];
const md=decisions[Math.floor(Math.random()*3)];
const cd=decisions[Math.floor(Math.random()*3)];
document.getElementById('b-decision').textContent=bd;
document.getElementById('m-decision').textContent=md;
document.getElementById('c-decision').textContent=cd;
document.getElementById('b-decision').className='decision '+(bd==='承認'?'approve':bd==='否認'?'reject':'hold');
document.getElementById('m-decision').className='decision '+(md==='承認'?'approve':md==='否認'?'reject':'hold');
document.getElementById('c-decision').className='decision '+(cd==='承認'?'approve':cd==='否認'?'reject':'hold');
let final='保留';
const all=[bd,md,cd];
if(all.filter(x=>x==='承認').length>=2)final='承認';
else if(all.filter(x=>x==='否認').length>=2)final='否認';
document.getElementById('final-decision').textContent='最終決定: '+final;
document.getElementById('final-decision').className='decision '+(final==='承認'?'approve':final==='否認'?'reject':'hold');
}
}
</script>
</body></html>
document.getElementById('c-decision').className='decision '+(cd==='承認'?'approve':cd==='否認'?'reject':'hold');
let final='保留';
const all=[bd,md,cd];
if(all.filter(x=>x==='承認').length>=2)final='承認';
else if(all.filter(x=>x==='否認').length>=2)final='否認';
document.getElementById('final-decision').textContent='決定: '+final;
document.getElementById('final-decision').className='decision '+(final==='承認'?'approve':final==='否認'?'reject':'hold');
}
if(d.candidates){
document.getElementById('b-text').textContent=d.candidates[0].text;
document.getElementById('m-text').textContent=d.candidates[1].text;
document.getElementById('c-text').textContent=d.candidates[2].text;
}
}
</script>
</body></html>
